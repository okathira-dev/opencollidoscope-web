# Scratchpad

このファイルは、タスクの計画と進捗状況を追跡するためのスクラッチパッドとして使用されます。
（`.cursor/rules/global.mdc`のルールに従って管理されています）

## 現在のタスク

opencollidoscopeのハードウェア設計図やコードを調査し、ウェブ版実装を作成する
- 元のピアノ鍵盤部分はPCキーボードでも弾けるようにする
- ハードウェア設計とコードの理解
- ウェブ版アーキテクチャの設計
- 実装とテスト

## 進捗状況

[X] opencollidoscopeプロジェクトの調査・理解
[ ] ハードウェア設計図の分析
[ ] 既存コードの分析
[ ] ウェブ版アーキテクチャの設計
[ ] 基本的なWeb UI実装
[ ] ピアノ鍵盤機能の実装（マウス+キーボード対応）
[ ] 音響処理・視覚効果の実装
[ ] 統合テストとデバッグ

## 調査結果

### opencollidoscopeプロジェクト概要
- **開発者**: Ben Bengler, Fiore Martin @ Queen Mary University of London, Center for Digital Music
- **概要**: インタラクティブな協調的音響機器・グラニュラーシンセサイザー
- **目的**: 参加者がリアルタイムで音を録音、操作、探索、演奏できる楽器
- **対象**: アマチュアからプロまで対応
- **ライセンス**: GPL v3
- **技術**: グラニュラー合成エンジン、MIDIメッセージ制御、物理的ハードウェア + ソフトウェア

### 技術仕様（推定）
- **音響エンジン**: グラニュラー合成（Ross Bencina論文ベース、SuperCollider TGrains UGen）
- **制御**: MIDIメッセージベース
- **ハードウェア**: Teensyマイコン + センサー + PCB
- **入力**: 物理的な鍵盤・センサー（ピアノ鍵盤含む）
- **出力**: リアルタイム音響合成 + 視覚的フィードバック

### 実装できない制約
- 公式ソースコードが直接入手困難
- ハードウェア設計図の詳細が不明
- 具体的な音響処理アルゴリズムの詳細が不明

## 設計方針

### ウェブ版アーキテクチャ設計
1. **基本構成**: HTML5 + Web Audio API + Canvas API
2. **音響エンジン**: Web Audio APIベースのグラニュラー合成
3. **入力方式**: 
   - PCキーボード（ピアノ鍵盤マッピング）
   - マウス/タッチ（画面上の仮想鍵盤）
   - Web MIDI API（外部MIDIデバイス対応）
4. **視覚効果**: Canvas APIによるリアルタイム視覚化
5. **録音機能**: MediaRecorder API + getUserMedia
6. **ファイル管理**: IndexedDB/localStorage

## リポジトリ構造分析結果

## ルール間の整合性

- 基本的に整合性は保たれています
- 最近の変更：
  - `global.mdc`とScratchpad.mdの関係を明確化
  - Lessons.mdファイルを作成し、Lessonsに関する情報をglobal.mdcから分離
  - global.mdcに他のルールファイルとの関連性を明示的に記載
  - global.mdcを日本語化し、内容の一貫性を向上（コマンド例の文字列は技術的な正確性のため原文のまま）

## メモと反省

- ルールファイルは適切に整理・構造化されている
- ルールの分割と再構成により、責任範囲がより明確になった
- 日本語化によりグローバルルールの一貫性が向上した
- コマンド例やプロンプトなどの技術的な文字列は原文のままにすることで正確性を確保
- ドキュメントとルールファイルの相互参照により、プロジェクト全体の把握がしやすくなった
